import java.util.*;
import java.io.File;
import java.io.*;
import java.io.IOException;
import java.io.OutputStream;
import java.io.FileInputStream;
import java.awt.Color;
import java.sql.*;

import net.sf.jasperreports.engine.JREmptyDataSource;
import net.sf.jasperreports.engine.JRDataSource;
import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JRRectangle;
import net.sf.jasperreports.engine.JRStyle;
import net.sf.jasperreports.engine.JasperExportManager;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperCompileManager;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.engine.util.JRLoader;
import net.sf.jasperreports.engine.util.JRSaver;
import net.sf.jasperreports.engine.JasperPrintManager;
import net.sf.jasperreports.engine.data.JRXmlDataSource;


import net.sf.jasperreports.engine.design.*;
import net.sf.jasperreports.engine.xml.*;



public class DebugCompile{
  /**
	 *
	 */
	private static void usage()
	{
		System.out.println( "DebugFill usage:" );
		System.out.println( "\tjava DebugCompile -Ffile" );
             System.out.println( "\tjava DebugCompile -F*.jrxml" );
	}      

public static void main(String args[]) {

          String fileName = null;

           if(args.length == 0){
	         usage();
	         return;
                 }
             int k = 0;
		while ( args.length > k )
		{
			if ( args[k].startsWith("-F") )
				fileName = args[k].substring(2);
			
			k++;
		}



            /*
               do compile *.jrxml To *.jasper */
    try {
        JasperDesign jasperDesign = JRXmlLoader.load(fileName);
        JasperCompileManager jcm = new JasperCompileManager();
                             jcm.compileReportToFile("SubSum.jrxml","SubSum.jasper");
                             jcm.compileReportToFile(jasperDesign,"SubRow.jasper");//compile sub jasper
           /*
               do *.jasper To *.jrprint */

        JasperReport jasperReport = (JasperReport)JRLoader.loadObject("SubRow.jasper");
        JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, null, 
            new JRXmlDataSource("data.xml", "/XpcJRDataSource/DSSub/DSSubRows"));

	  //File destFile = new File("test.jrprint");

	  //JRSaver.saveObject(jasperPrint, destFile);
       JasperExportManager.exportReportToPdfFile(jasperPrint,"SubRow.pdf");

	  System.err.println("Compile File is test.jasper and SubRow.pdf");
				
             }
             catch (JRException e)
		{
			e.printStackTrace();
			System.exit(1);
		}
		catch (Exception e)
		{
			e.printStackTrace();
			System.exit(1);
		}
            
          }
}
